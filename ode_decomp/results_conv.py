import get_oslo_data

import pandas as pd

data_folder = "oslo_data_4"
prices = [0.8499999999999998, 1.2000000000000002, 1.0999999999999999, 0.7999999999999998, 0.8999999999999997, 0.8999999999999997, 0.8499999999999998, 1.25, 0.8499999999999998, 1.3500000000000005, 1.2000000000000004, 0.7999999999999994, 1.0499999999999998, 1.1, 1.0999999999999999, 1.1, 1.2000000000000002, 1.15, 1.1500000000000001, 1.3000000000000003, 0.95, 0.9500000000000002, 1.0, 1.1, 1.15, 1.05, 1.2000000000000002, 1.2, 1.1, 0.95, 1.3000000000000003, 1.15, 0.9499999999999994, 0.8999999999999999, 0.8999999999999998, 1.2500000000000002, 0.8499999999999996, 1.1500000000000001, 1.1500000000000001, 1.3000000000000003, 0.6999999999999997, 0.8499999999999998, 1.0]


cell_levels = [0.35000000000000003, 0.8000000000000003, 0.8000000000000003, 0.4, 0.15000000000000008, 0.5, 0.5, 0.7500000000000002, 0.25000000000000006, 0.6500000000000001, 0.7500000000000002, 0.35000000000000003, 0.7500000000000002, 0.7000000000000002, 0.6000000000000001, 0.7500000000000002, 0.8000000000000003, 0.6500000000000001, 0.7500000000000002, 0.8000000000000003, 0.8000000000000003, 0.7500000000000002, 0.6000000000000001, 0.7500000000000002, 0.8000000000000003, 0.7000000000000002, 0.7500000000000002, 0.8000000000000003, 0.7000000000000002, 0.6500000000000001, 0.7500000000000002, 0.7500000000000002, 0.45, 0.35000000000000003, 0.6500000000000001, 0.45, 0.5, 0.7500000000000002, 0.8500000000000003, 0.7000000000000002, 0.30000000000000004, 0.4, 0.6500000000000001]



if __name__ == "__main__":
    print(f"average price: {sum(prices)/len(prices)}")
    print(f"average cell level: {sum(cell_levels)/len(cell_levels)}")
    stations = pd.read_csv(f"{data_folder}/stations.csv").rename({"Unnamed: 0": "station"}, axis=1)

    n_cells = int(stations["cell"].max() + 1)

    stations[0] = stations["cell"].apply(lambda x: prices[int(x)])
    stations["x0"] = stations.apply(lambda row: cell_levels[int(row["cell"])]*int(row["capacity"]), axis=1)

    stations = stations[[0, "station", "x0"]]

    stations.to_csv(f"orig_prices/prices.csv")
